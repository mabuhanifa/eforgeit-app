# Window Functions

A window function performs a calculation across a set of table rows that are somehow related to the current row. This is comparable to the type of calculation that can be done with an aggregate function. But unlike regular aggregate functions, use of a window function does not cause rows to become grouped into a single output row.

### Introduction to Window Functions

The basic syntax is `function_name() OVER (PARTITION BY ... ORDER BY ...)`.

- `PARTITION BY`: Divides the rows into partitions (groups). The function is applied independently to each partition.
- `ORDER BY`: Orders the rows within each partition.

### Ranking Functions

- `ROW_NUMBER()`: Assigns a unique number to each row within its partition.
- `RANK()`: Assigns a rank to each row. Skips ranks after ties.
- `DENSE_RANK()`: Assigns a rank to each row. Does not skip ranks after ties.

```sql
-- Rank employees by salary within each department
SELECT
    first_name,
    salary,
    department_name,
    RANK() OVER (PARTITION BY department_name ORDER BY salary DESC) as salary_rank
FROM employees
JOIN departments ON employees.department_id = departments.department_id;
```

### Aggregate Window Functions

You can use aggregate functions like `SUM()`, `AVG()`, and `COUNT()` as window functions.

```sql
-- Show each employee's salary along with the average salary for their department
SELECT
    first_name,
    salary,
    department_name,
    AVG(salary) OVER (PARTITION BY department_name) as avg_department_salary
FROM employees
JOIN departments ON employees.department_id = departments.department_id;
```
